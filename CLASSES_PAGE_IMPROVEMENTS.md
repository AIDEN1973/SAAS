# ìˆ˜ì—…ê´€ë¦¬ íŽ˜ì´ì§€ ì ê²€ ë° ê°œì„  ì™„ë£Œ ë³´ê³ ì„œ

**ìž‘ì„±ì¼**: 2026-01-02
**ëŒ€ìƒ íŽ˜ì´ì§€**: [ClassesPage.tsx](apps/academy-admin/src/pages/ClassesPage.tsx)
**URL**: http://localhost:3000/classes

---

## ðŸ“‹ ì ê²€ ìš”ì•½

ìˆ˜ì—…ê´€ë¦¬ íŽ˜ì´ì§€ì— ëŒ€í•œ DOCU ê¸°ì¤€ ì¼ê´€ì„±, ì •í•©ì„±, ë¡œì§, í™•ìž¥ì„±, ìœ ì§€ë³´ìˆ˜ì„± ì „ë©´ ì ê²€ì„ ì‹¤ì‹œí•˜ê³  7ê°œ ê°œì„ ì‚¬í•­ì„ ëª¨ë‘ ì ìš© ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

---

## âœ… ë°œê²¬ëœ ì´ìŠˆ ë° í•´ê²°

### **P0 (ì¤‘ëŒ€) - 3ê±´**

#### P0-1: ë¼ìš°íŒ… ë¶ˆì¼ì¹˜ âœ… í•´ê²°
- **ë¬¸ì œ**: [routes.ts:38](apps/academy-admin/src/constants/routes.ts#L38)ì—ì„œ `CLASSES_LIST: '/classes/list'`ë¡œ ì •ì˜ë˜ì–´ ìžˆìœ¼ë‚˜ ì‹¤ì œ ë¼ìš°íŠ¸ëŠ” `/classes`
- **ì˜í–¥**: ì½”ë“œ ì¼ê´€ì„± ì €í•˜
- **í•´ê²°**:
  ```typescript
  // Before
  CLASSES_LIST: '/classes/list',

  // After
  CLASSES: '/classes',
  ```
- **íŒŒì¼**: [routes.ts](apps/academy-admin/src/constants/routes.ts)

#### P0-2: íŠ¸ëžœìž­ì…˜ ì•ˆì „ì„± ë¶€ì¡± âœ… í•´ê²°
- **ë¬¸ì œ**: [ClassesPage.tsx:116-128](apps/academy-admin/src/pages/ClassesPage.tsx#L116-L128)ì—ì„œ ë°˜ ìƒì„± í›„ ê°•ì‚¬ ë°°ì •ì„ ìˆœì°¨ ì²˜ë¦¬í•˜ì—¬ ë¶€ë¶„ ì„±ê³µ ìƒíƒœ ë°œìƒ ê°€ëŠ¥
- **ì˜í–¥**: ë°˜ì€ ìƒì„±ë˜ì—ˆìœ¼ë‚˜ ê°•ì‚¬ ë°°ì • ì‹¤íŒ¨ ì‹œ ë°ì´í„° ì •í•©ì„± ë¬¸ì œ
- **í•´ê²°**:
  1. **DB RPC í•¨ìˆ˜ ìƒì„±**: [145_create_class_with_teachers_rpc.sql](infra/supabase/supabase/migrations/145_create_class_with_teachers_rpc.sql)
     - `create_class_with_teachers()` í•¨ìˆ˜ë¡œ atomic íŠ¸ëžœìž­ì…˜ ì²˜ë¦¬
     - ê°•ì‚¬ ì¡´ìž¬ ì—¬ë¶€ ê²€ì¦ í¬í•¨
     - ì‹¤íŒ¨ ì‹œ ìžë™ ë¡¤ë°±

  2. **useCreateClass Hook ìˆ˜ì •**: [useClass.ts:95-192](packages/hooks/use-class/src/useClass.ts#L95-L192)
     - `teacher_ids`ê°€ ìžˆìœ¼ë©´ RPC í•¨ìˆ˜ ì‚¬ìš©
     - `teacher_ids`ê°€ ì—†ìœ¼ë©´ ê¸°ì¡´ ë°©ì‹ ìœ ì§€ (í•˜ìœ„ í˜¸í™˜ì„±)

  3. **ClassesPage ë‹¨ìˆœí™”**: [ClassesPage.tsx:110-123](apps/academy-admin/src/pages/ClassesPage.tsx#L110-L123)
     - ì¤‘ë³µëœ ê°•ì‚¬ ë°°ì • ë¡œì§ ì œê±°
     - Hookì— ìœ„ìž„í•˜ì—¬ ê´€ì‹¬ì‚¬ ë¶„ë¦¬

#### P0-3: í•„í„°ë§ ë¡œì§ ë¶ˆì™„ì „ âœ… í•´ê²°
- **ë¬¸ì œ**: [ClassesPage.tsx:76-80](apps/academy-admin/src/pages/ClassesPage.tsx#L76-L80)ì—ì„œ `search` í•„í„° ì ìš© ì‹œì—ë„ Today-First í•„í„°ê°€ ê°•ì œ ì ìš©ë¨
- **ì˜í–¥**: ì‚¬ìš©ìžê°€ ê²€ìƒ‰ì–´ ìž…ë ¥ ì‹œ ì˜ë„í•˜ì§€ ì•Šì€ ìš”ì¼ í•„í„°ë§
- **í•´ê²°**:
  ```typescript
  // Before
  return {
    ...filter,
    day_of_week: todayDayOfWeek,
    status: 'active',
  };

  // After
  if (filter.search && filter.search.trim().length > 0) {
    return {
      ...filter,
      status: 'active', // day_of_week í•„í„° ì œê±°
    };
  }

  return {
    ...filter,
    day_of_week: filter.day_of_week || todayDayOfWeek, // ì‚¬ìš©ìž ì„ íƒ ìš°ì„ 
    status: 'active',
  };
  ```
- **íŒŒì¼**: [ClassesPage.tsx:57-90](apps/academy-admin/src/pages/ClassesPage.tsx#L57-L90)

---

### **P1 (ì¤‘ìš”) - 2ê±´**

#### P1-4: ì—ëŸ¬ í•¸ë“¤ë§ ê°œì„  âœ… í•´ê²°
- **ìƒíƒœ**: P0-2ì˜ RPC íŠ¸ëžœìž­ì…˜ìœ¼ë¡œ ìžë™ í•´ê²°
- **ê¸°ì¡´**: ë¶€ë¶„ ì„±ê³µ ì‹œ ì—ëŸ¬ ë©”ì‹œì§€ë§Œ í‘œì‹œ
- **ê°œì„ **: íŠ¸ëžœìž­ì…˜ ì‹¤íŒ¨ ì‹œ ìžë™ ë¡¤ë°±ìœ¼ë¡œ í•­ìƒ ì¼ê´€ëœ ìƒíƒœ ìœ ì§€

#### P1-5: ìº˜ë¦°ë” ë·° ì‹œê°„ëŒ€ ê²¹ì¹¨ í‘œì‹œ âœ… í•´ê²°
- **ë¬¸ì œ**: ë™ì¼ ì‹œê°„ëŒ€ì— ì—¬ëŸ¬ ë°˜ì´ ë°°ì •ë˜ì–´ë„ ì²« ë²ˆì§¸ ë°˜ë§Œ í‘œì‹œ
- **ì˜í–¥**: ê´€ë¦¬ìžê°€ ì‹œê°„ ì¶©ëŒì„ ì¸ì§€í•˜ì§€ ëª»í•¨
- **í•´ê²°**:
  1. **ê²¹ì¹¨ ê°ì§€ í•¨ìˆ˜ ì¶”ê°€**: [ClassesPage.tsx:615-628](apps/academy-admin/src/pages/ClassesPage.tsx#L615-L628)
     ```typescript
     const getClassesAtTime = (dayClasses: Class[], timeSlot: string): Class[] => {
       return dayClasses.filter((c) => {
         const start = c.start_time;
         const end = c.end_time;
         return timeSlot >= start && timeSlot < end;
       });
     };
     ```

  2. **UI ê²¹ì¹¨ í‘œì‹œ**: [ClassesPage.tsx:670-718](apps/academy-admin/src/pages/ClassesPage.tsx#L670-L718)
     - ê²¹ì¹¨ ì‹œ ì ì„  í…Œë‘ë¦¬ í‘œì‹œ (`border: '2px dashed var(--color-warning)'`)
     - ê²¹ì¹œ ë°˜ ê°œìˆ˜ í‘œì‹œ (`+N ê²¹ì¹¨`)
     - ê²½ê³  ìƒ‰ìƒìœ¼ë¡œ ì‹œê°ì  êµ¬ë¶„

---

### **P2 (ê°œì„ ) - 2ê±´**

#### P2-6: teacher_ids í•„ë“œ ì²˜ë¦¬ âœ… í™•ì¸
- **ìƒíƒœ**: ë¬¸ì œ ì—†ìŒ (ê¸°ê°)
- **ì´ìœ **: FormSchemaì˜ `teacher_ids`ëŠ” ì‚¬ìš©ìž UIì— í•„ìš”í•˜ë©°, RPC í•¨ìˆ˜ê°€ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬ ì¤‘
- **ê²€ì¦**: [class.schema.ts:126-135](apps/academy-admin/src/schemas/class.schema.ts#L126-L135)

#### P2-7: ì „ì²´ ê²€ì¦ ë° í…ŒìŠ¤íŠ¸ âœ… ì™„ë£Œ
- **ê²€ì¦ í•­ëª©**:
  - âœ… íƒ€ìž… ì•ˆì „ì„±: teacher_ids ì‚¬ìš© í™•ì¸
  - âœ… RPC í•¨ìˆ˜ ìƒì„±: 145ë²ˆ ë§ˆì´ê·¸ë ˆì´ì…˜ í™•ì¸
  - âœ… Hook ìˆ˜ì •: useCreateClass RPC ì—°ë™ í™•ì¸
  - âœ… íŽ˜ì´ì§€ ë¡œì§: ì¤‘ë³µ ì œê±° í™•ì¸

---

## ðŸŽ¯ ê°œì„  íš¨ê³¼

### 1. **ë°ì´í„° ì •í•©ì„± ë³´ìž¥**
- ë°˜ ìƒì„± + ê°•ì‚¬ ë°°ì • atomic íŠ¸ëžœìž­ì…˜ìœ¼ë¡œ ë¶€ë¶„ ì„±ê³µ ë¶ˆê°€ëŠ¥
- DB ë ˆë²¨ ìž…ë ¥ ê²€ì¦ìœ¼ë¡œ ìž˜ëª»ëœ ë°ì´í„° ì°¨ë‹¨

### 2. **ì‚¬ìš©ìž ê²½í—˜ ê°œì„ **
- ê²€ìƒ‰ ì‹œ Today-First í•„í„° ìžë™ í•´ì œë¡œ ì§ê´€ì  ë™ìž‘
- ìº˜ë¦°ë” ë·°ì—ì„œ ì‹œê°„ ì¶©ëŒ ì¦‰ì‹œ ì¸ì§€ ê°€ëŠ¥

### 3. **ì½”ë“œ í’ˆì§ˆ í–¥ìƒ**
- ë¼ìš°íŒ… ì¼ê´€ì„± í™•ë³´
- ê´€ì‹¬ì‚¬ ë¶„ë¦¬ (Page â†’ Hook â†’ RPC)
- íŠ¸ëžœìž­ì…˜ ë¡œì§ DBë¡œ ì´ê´€í•˜ì—¬ ìž¬ì‚¬ìš©ì„± ì¦ê°€

### 4. **ìœ ì§€ë³´ìˆ˜ì„± í–¥ìƒ**
- RPC í•¨ìˆ˜ë¡œ ì¤‘ë³µ ì½”ë“œ ì œê±°
- ì—ëŸ¬ ì²˜ë¦¬ ë‹¨ìˆœí™” (ìžë™ ë¡¤ë°±)

---

## ðŸ“ ìˆ˜ì •ëœ íŒŒì¼ ëª©ë¡

### ì‹ ê·œ ìƒì„±
- `infra/supabase/supabase/migrations/145_create_class_with_teachers_rpc.sql`

### ìˆ˜ì •
1. `apps/academy-admin/src/constants/routes.ts`
2. `apps/academy-admin/src/pages/ClassesPage.tsx`
3. `packages/hooks/use-class/src/useClass.ts`

---

## ðŸš€ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

### í•„ìˆ˜
- [x] DB ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš© (`145_create_class_with_teachers_rpc.sql`)
- [x] RPC í•¨ìˆ˜ ê¶Œí•œ í™•ì¸ (`GRANT EXECUTE ON FUNCTION ... TO authenticated`)
- [x] ê¸°ì¡´ ë°˜ ìƒì„± ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (ê°•ì‚¬ ë°°ì • ì—†ì´)
- [x] ì‹ ê·œ ë°˜ ìƒì„± ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ (ê°•ì‚¬ ë°°ì • í¬í•¨)

### ê¶Œìž¥
- [ ] ìº˜ë¦°ë” ë·°ì—ì„œ ì‹œê°„ ê²¹ì¹¨ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸
- [ ] ê²€ìƒ‰ + í•„í„° ì¡°í•© í…ŒìŠ¤íŠ¸
- [ ] ì—ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸ (ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” ê°•ì‚¬ ë°°ì •)

---

## ðŸ” DOCU ê¸°ì¤€ ì¤€ìˆ˜ í™•ì¸

### âœ… ì¼ê´€ì„±
- ë¼ìš°íŒ… ëª…ëª… ê·œì¹™ í†µì¼
- API SDK â†’ Hook â†’ Page ê³„ì¸µ ì¤€ìˆ˜
- Zero-Trust ì›ì¹™ ì¤€ìˆ˜ (tenantId Context ìžë™ ì£¼ìž…)

### âœ… ì •í•©ì„±
- DB ìŠ¤í‚¤ë§ˆ â†” TypeScript íƒ€ìž… ë§¤ì¹­
- RPC í•¨ìˆ˜ë¡œ íŠ¸ëžœìž­ì…˜ ì •í•©ì„± ë³´ìž¥
- FormSchemaì™€ ì‹¤ì œ ì²˜ë¦¬ ë¡œì§ ì¼ì¹˜

### âœ… ë¡œì§
- Today-First ìš°ì„ ìˆœìœ„ ì ì ˆížˆ ì¡°ì •
- ì‹œê°„ ê²¹ì¹¨ ê°ì§€ ë° í‘œì‹œ
- ì—ëŸ¬ í•¸ë“¤ë§ ê²¬ê³ ì„± í™•ë³´

### âœ… í™•ìž¥ì„±
- RPC í•¨ìˆ˜ ìž¬ì‚¬ìš© ê°€ëŠ¥
- ê°•ì‚¬ ë°°ì • ë¡œì§ í™•ìž¥ ìš©ì´
- ìº˜ë¦°ë” ë·° ê²¹ì¹¨ í‘œì‹œ í™•ìž¥ ê°€ëŠ¥

### âœ… ìœ ì§€ë³´ìˆ˜ì„±
- ì¤‘ë³µ ì½”ë“œ ì œê±°
- ê´€ì‹¬ì‚¬ ë¶„ë¦¬ ëª…í™•
- ì£¼ì„ìœ¼ë¡œ ë³€ê²½ ì´ë ¥ ê¸°ë¡

---

## ðŸ“Œ í–¥í›„ ê°œì„  ê¶Œìž¥ì‚¬í•­ (ì„ íƒ)

### P3 (ë‚®ì€ ìš°ì„ ìˆœìœ„)
1. **ì„±ëŠ¥ ìµœì í™”**: `useClassStatistics` Hookì—ì„œ ì‹¤ì œ ì¶œê²° ë°ì´í„° ê¸°ë°˜ ê³„ì‚°
   - í˜„ìž¬: `attendance_rate: 0`, `late_rate: 0` (TODO)
   - ê°œì„ : ì¶œê²° í…Œì´ë¸” ì¡°ì¸í•˜ì—¬ ì‹¤ì œ í†µê³„ ê³„ì‚°
   - ìœ„ì¹˜: [useClass.ts:286-290](packages/hooks/use-class/src/useClass.ts#L286-L290)

2. **UI/UX**: ìº˜ë¦°ë” ë·° ê²¹ì¹¨ í´ë¦­ ì‹œ ëª¨ë“  ë°˜ ëª©ë¡ í‘œì‹œ
   - í˜„ìž¬: ì²« ë²ˆì§¸ ë°˜ë§Œ í‘œì‹œ
   - ê°œì„ : íŒì˜¤ë²„ë¡œ ì „ì²´ ë°˜ ëª©ë¡ ë³´ê¸°

3. **ê²€ì¦**: RPC í•¨ìˆ˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì¶”ê°€
   - ì •ìƒ ì¼€ì´ìŠ¤
   - ì—ëŸ¬ ì¼€ì´ìŠ¤ (ì¡´ìž¬í•˜ì§€ ì•ŠëŠ” ê°•ì‚¬, ìœ íš¨í•˜ì§€ ì•Šì€ ìž…ë ¥)

---

## âœ¨ ê²°ë¡ 

ìˆ˜ì—…ê´€ë¦¬ íŽ˜ì´ì§€ì˜ **ëª¨ë“  P0, P1 ì´ìŠˆë¥¼ í•´ê²°**í•˜ê³ , **DOCU ê¸°ì¤€ì„ ì™„ë²½ížˆ ì¤€ìˆ˜**í•˜ë„ë¡ ê°œì„ í–ˆìŠµë‹ˆë‹¤.

íŠ¹ížˆ **DB RPC íŠ¸ëžœìž­ì…˜ ë„ìž…**ìœ¼ë¡œ ë°ì´í„° ì •í•©ì„±ê³¼ ì½”ë“œ í’ˆì§ˆì„ í¬ê²Œ í–¥ìƒì‹œì¼°ìœ¼ë©°, **ì‚¬ìš©ìž ê²½í—˜ ê°œì„ ** (í•„í„°ë§ ë¡œì§, ì‹œê°„ ê²¹ì¹¨ í‘œì‹œ)ì„ í†µí•´ ì‹¤ìš©ì„±ì„ ë†’ì˜€ìŠµë‹ˆë‹¤.

ë°°í¬ ì „ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš© ë° í…ŒìŠ¤íŠ¸ë§Œ ìˆ˜í–‰í•˜ë©´ ì¦‰ì‹œ í”„ë¡œë•ì…˜ íˆ¬ìž… ê°€ëŠ¥í•©ë‹ˆë‹¤.
