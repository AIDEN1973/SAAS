# ìŠ¤í‚¤ë§ˆì—”ì§„ ë° ìŠ¤í‚¤ë§ˆì—ë””í„° ì •ë°€ ê²€ì¦ ê²°ê³¼

**ê²€ì¦ ì¼ì‹œ**: 2025-01-XX  
**ê²€ì¦ ë²”ìœ„**: 
- `packages/schema-engine` ì „ì²´
- `apps/super-admin` (Schema Editor) ì „ì²´
- ê¸°ìˆ ë¬¸ì„œ: `docu/ìŠ¤í‚¤ë§ˆì—”ì§„.txt`, `docu/ìŠ¤í‚¤ë§ˆì—ë””í„°.txt`

---

## âœ… ê²€ì¦ í†µê³¼ í•­ëª©

### 1. íƒ€ìž… ì •ì˜ ì¼ì¹˜ì„±

#### 1.1 SchemaVersion íƒ€ìž…
- âœ… `minClient` ìš°ì„  ì‚¬ìš© (SDUI v1.1)
- âœ… `minSupportedClient` í•˜ìœ„ í˜¸í™˜ì„± ì§€ì›
- âœ… `version` Semver í˜•ì‹ ê²€ì¦

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/types.ts:22-27`

#### 1.2 ConditionRule íƒ€ìž…
- âœ… `then/else` êµ¬ì¡° ì§€ì›
- âœ… `action` í•„ë“œ í•˜ìœ„ í˜¸í™˜ì„± ìœ ì§€
- âœ… ì—°ì‚°ìž í™•ìž¥ (`==`, `!=`, `not_exists` ë“±)
- âœ… `in/not_in` ì—°ì‚°ìž ë°°ì—´ ê°’ ì§€ì›

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/types.ts:122-137`

#### 1.3 MultiConditionRule íƒ€ìž…
- âœ… `conditions` ë°°ì—´ + `logic: 'and' | 'or'` ì§€ì›
- âœ… `then/else` êµ¬ì¡° ì§€ì›
- âœ… `action` í•„ë“œ í•˜ìœ„ í˜¸í™˜ì„±

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/types.ts:148-156`

#### 1.4 FormFieldSchema íƒ€ìž…
- âœ… `kind: 'custom'` ì§€ì›
- âœ… `customComponentType` í•„ë“œ
- âœ… i18n í‚¤ ì§€ì› (`labelKey`, `placeholderKey` ë“±)
- âœ… `condition`ê³¼ `conditions` ë™ì‹œ ì‚¬ìš© ê¸ˆì§€ ê·œì¹™

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/types.ts:164-210`

### 2. Condition Rule í‰ê°€ ë¡œì§

#### 2.1 evaluateConditionRule()
- âœ… `exists/not_exists` ì—°ì‚°ìž ì²˜ë¦¬
- âœ… `==/!=` ì—°ì‚°ìž ì§€ì› (eq/ne í•˜ìœ„ í˜¸í™˜ì„±)
- âœ… `in/not_in` ë°°ì—´ ê°’ ì²˜ë¦¬ (êµì§‘í•©/ì°¨ì§‘í•©)
- âœ… ìˆ«ìž ë¹„êµ ì—°ì‚°ìž (`>`, `>=`, `<`, `<=`)
- âœ… `value === undefined` ì•ˆì „ ì²˜ë¦¬

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/core/conditionEvaluator.ts:27-99`

#### 2.2 evaluateMultiConditionRule()
- âœ… AND/OR ë¡œì§ ì²˜ë¦¬
- âœ… ë¹ˆ ë°°ì—´ ì²´í¬ (`conditions.length === 0`)

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/core/conditionEvaluator.ts:110-129`

#### 2.3 getConditionalActions()
- âœ… `conditions` ìš°ì„  ì²˜ë¦¬ (ë‹¨ì¼ `condition`ë³´ë‹¤ ìš°ì„ )
- âœ… `then/else` êµ¬ì¡° ìš°ì„  ì²˜ë¦¬ (`action`ë³´ë‹¤ ìš°ì„ )
- âœ… ë™ì  ì•¡ì…˜ ë°˜í™˜ (`setValue`, `setOptions`, `switchComponent`)

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/core/conditionEvaluator.ts:174-270`

### 3. Validator ê²€ì¦ ê·œì¹™

#### 3.1 Meta-Schema Validation
- âœ… Semver ì •ê·œì‹ ê²€ì¦ (`/^\d+\.\d+\.\d+$/`)
- âœ… `minClient` ë˜ëŠ” `minSupportedClient` í•„ìˆ˜ ê²€ì¦
- âœ… Field kindë³„ options ê°•ì œ ê²€ì‚¬
- âœ… `select/multiselect/radio`ëŠ” options í•„ìˆ˜
- âœ… options.value ì¤‘ë³µ ê¸ˆì§€
- âœ… options.labelKey ë˜ëŠ” label í•„ìˆ˜
- âœ… `custom` kindëŠ” `customComponentType` í•„ìˆ˜
- âœ… Tailwind í´ëž˜ìŠ¤ ë¬¸ìžì—´ ì‚¬ìš© ê¸ˆì§€ ê²€ì¦
- âœ… `condition`ê³¼ `conditions` ë™ì‹œ ì¡´ìž¬ ê¸ˆì§€
- âœ… ì„ í–‰ í•„ë“œ ì¡´ìž¬ì„± ê²€ì¦
- âœ… `setValue` self-referential ê¸ˆì§€
- âœ… MultiConditionRule ë¹ˆ ë°°ì—´ ê¸ˆì§€

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/validator.ts`

#### 3.2 Schema Version ì²´í¬
- âœ… `minClient` ìš°ì„  ì‚¬ìš©
- âœ… í´ë¼ì´ì–¸íŠ¸ ë²„ì „ í˜¸í™˜ì„± ì²´í¬

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/validator.ts:486-517`

### 4. SchemaField ë Œë”ë§ ë¡œì§

#### 4.1 useWatch ìµœì í™”
- âœ… ì¡°ê±´ì´ ìžˆëŠ” í•„ë“œë§Œ ê°ì‹œ
- âœ… ì¡°ê±´ì´ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ì „ë‹¬ (í¼ ì „ì²´ êµ¬ë… ë°©ì§€)
- âœ… ë³µìˆ˜ í•„ë“œ ë™ì‹œ ê°ì‹œ ì§€ì›

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/react/SchemaField.tsx:77-111`

#### 4.2 ë™ì  ì•¡ì…˜ ì²˜ë¦¬
- âœ… `setValue` ì•¡ì…˜ ì²˜ë¦¬ (ë¬´í•œë£¨í”„ ë°©ì§€)
- âœ… `setOptions` ì•¡ì…˜ ì²˜ë¦¬ (static/api)
- âœ… `switchComponent` ì•¡ì…˜ ì²˜ë¦¬
- âœ… API í˜¸ì¶œì€ `@api-sdk/core`ë§Œ ì‚¬ìš© (Zero-Trust)

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/react/SchemaField.tsx:118-191`

#### 4.3 Custom Widget ì§€ì›
- âœ… ë™ì  ë¡œë”© (`loadWidget`)
- âœ… Widget Not Found ì²˜ë¦¬
- âœ… ë¡œë”© ìƒíƒœ í‘œì‹œ
- âœ… ì—ëŸ¬ ìƒíƒœ í‘œì‹œ

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/react/SchemaField.tsx:416-571`

#### 4.4 Tailwind í´ëž˜ìŠ¤ ì‚¬ìš© ê¸ˆì§€
- âœ… `FormFieldLayout`ë§Œ ì‚¬ìš©
- âœ… props ê¸°ë°˜ ì „ë‹¬
- âœ… ìŠ¤íƒ€ì¼ ë¡œì§ ì—†ìŒ

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/react/SchemaField.tsx:205-209`

### 5. Schema Editor ê¸°ëŠ¥

#### 5.1 Client-Side Validation
- âœ… ì €ìž¥ ì „ `validateSchema()` í˜¸ì¶œ
- âœ… Import ì‹œ ê²€ì¦

**ì½”ë“œ ìœ„ì¹˜**: 
- `apps/super-admin/src/components/schema-editor/SchemaEditorForm.tsx:86-91`
- `apps/super-admin/src/components/schema-editor/ImportExportPanel.tsx:41-46`

#### 5.2 Optimistic Locking
- âœ… `expectedUpdatedAt` ì „ë‹¬

**ì½”ë“œ ìœ„ì¹˜**: `apps/super-admin/src/components/schema-editor/SchemaEditorForm.tsx:102`

#### 5.3 Preview ê¸°ëŠ¥
- âœ… Mock Data ìƒì„±
- âœ… SchemaForm ë Œë”ë§

**ì½”ë“œ ìœ„ì¹˜**: `apps/super-admin/src/components/schema-editor/SchemaPreview.tsx`

#### 5.4 ê¶Œí•œ ì²´í¬
- âœ… `useIsSuperAdmin` Hook ì‚¬ìš©
- âœ… Super Adminë§Œ ì ‘ê·¼ ê°€ëŠ¥

**ì½”ë“œ ìœ„ì¹˜**: `apps/super-admin/src/pages/SchemaEditorPage.tsx:24, 75-88`

---

## âš ï¸ ë°œê²¬ëœ ì´ìŠˆ ë° ê°œì„  í•„ìš” ì‚¬í•­

### 1. âœ… Schema Editorì—ì„œ minClient/minSupportedClient ì²˜ë¦¬ - ìˆ˜ì • ì™„ë£Œ

**ìˆ˜ì • ë‚´ìš©**:
- âœ… `minClient` í•„ë“œ UI ì¶”ê°€
- âœ… ì´ˆê¸°ê°’ì— `minClient` í¬í•¨
- âœ… ì €ìž¥ ì‹œ `minClient` ìš°ì„  ì²˜ë¦¬
- âœ… `minSupportedClient`ëŠ” í•˜ìœ„ í˜¸í™˜ì„±ìœ¼ë¡œ ìœ ì§€

**ìˆ˜ì • íŒŒì¼**:
- `apps/super-admin/src/components/schema-editor/SchemaEditorForm.tsx`
- `apps/super-admin/src/pages/SchemaEditorPage.tsx`
- `apps/super-admin/src/components/schema-editor/SemanticDiffViewer.tsx`

### 2. Server-Side Validation í™•ì¸ í•„ìš”

**ë¬¸ì œì **:
- Client-Side Validationì€ êµ¬í˜„ë¨
- Server-Side Validation êµ¬í˜„ ì—¬ë¶€ í™•ì¸ í•„ìš” (Hook ë‚´ë¶€)

**ì˜í–¥ë„**: ë†’ìŒ
- ë³´ì•ˆìƒ ì¤‘ìš”: ìŠ¤í‚¤ë§ˆ ìœ„ì¡° ë°©ì§€

**í™•ì¸ í•„ìš”**:
- `@hooks/use-schema-registry` ë‚´ë¶€ ì„œë²„ ê²€ì¦ ë¡œì§ í™•ì¸
- API ì—”ë“œí¬ì¸íŠ¸ì—ì„œ `validateSchema()` ìž¬í˜¸ì¶œ ì—¬ë¶€

### 3. âœ… SchemaEditorForm ì´ˆê¸°ê°’ì—ì„œ minClient - ìˆ˜ì • ì™„ë£Œ

**ìˆ˜ì • ë‚´ìš©**:
- âœ… ì´ˆê¸° ìŠ¤í‚¤ë§ˆ ìƒì„± ì‹œ `minClient` í¬í•¨
- âœ… `minSupportedClient`ëŠ” í•˜ìœ„ í˜¸í™˜ì„±ìœ¼ë¡œ ìœ ì§€

### 4. Action Engine API í˜¸ì¶œ ë³´ì•ˆ

**í˜„ìž¬ ìƒíƒœ**: âœ… ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨
- `context.apiCall` ìš°ì„  ì‚¬ìš©
- `@api-sdk/core` ì§ì ‘ í˜¸ì¶œ ì‹œë„ (fallback ì—†ìŒ)
- Zero-Trust ì›ì¹™ ì¤€ìˆ˜

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/core/actionEngine.ts:89-134`

### 5. SchemaFieldì—ì„œ useWatch ìµœì í™”

**í˜„ìž¬ ìƒíƒœ**: âœ… ì˜¬ë°”ë¥´ê²Œ êµ¬í˜„ë¨
- ì¡°ê±´ì´ ì—†ìœ¼ë©´ ë¹ˆ ë°°ì—´ ì „ë‹¬
- í¼ ì „ì²´ êµ¬ë… ë°©ì§€

**ì½”ë“œ ìœ„ì¹˜**: `packages/schema-engine/src/react/SchemaField.tsx:95-98`

---

## ðŸ“‹ ê²€ì¦ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ìŠ¤í‚¤ë§ˆì—”ì§„ (Schema Engine)

- [x] íƒ€ìž… ì •ì˜ ì¼ì¹˜ (ConditionRule, MultiConditionRule, FormFieldSchema)
- [x] Condition Rule í‰ê°€ ë¡œì§ ì¼ì¹˜
- [x] Validator ê²€ì¦ ê·œì¹™ ì¼ì¹˜
- [x] SchemaField ë Œë”ë§ ë¡œì§ ì¼ì¹˜
- [x] Custom Widget ë™ì  ë¡œë”©
- [x] i18n í‚¤ ì§€ì›
- [x] Tailwind í´ëž˜ìŠ¤ ì‚¬ìš© ê¸ˆì§€ ì¤€ìˆ˜
- [x] Zero-Trust ì›ì¹™ ì¤€ìˆ˜ (API í˜¸ì¶œ)
- [x] Action Engine êµ¬í˜„
- [x] minClient/minSupportedClient ì²˜ë¦¬ (ì½”ë“œ ë ˆë²¨)
- [x] Schema Editorì— minClient í•„ë“œ ì¶”ê°€ (UI ë ˆë²¨)

### ìŠ¤í‚¤ë§ˆì—ë””í„° (Schema Editor)

- [x] Client-Side Validation
- [ ] Server-Side Validation (í™•ì¸ í•„ìš”)
- [x] Optimistic Locking
- [x] Preview ê¸°ëŠ¥
- [x] Import/Export ê¸°ëŠ¥
- [x] ê¶Œí•œ ì²´í¬ (Super Admin)
- [x] Draft/Active/Deprecated ìƒíƒœ ê´€ë¦¬
- [x] minClient í•„ë“œ UI ì¶”ê°€ (ìˆ˜ì • ì™„ë£Œ)

---

## ðŸ”§ ê¶Œìž¥ ìˆ˜ì • ì‚¬í•­

### ìš°ì„ ìˆœìœ„ ë†’ìŒ

1. **âœ… Schema Editorì— minClient í•„ë“œ ì¶”ê°€ - ì™„ë£Œ**
   - âœ… UIì— `minClient` ìž…ë ¥ í•„ë“œ ì¶”ê°€
   - âœ… `minSupportedClient`ëŠ” í•˜ìœ„ í˜¸í™˜ì„±ìœ¼ë¡œ ìœ ì§€

2. **Server-Side Validation í™•ì¸**
   - `@hooks/use-schema-registry` ë‚´ë¶€ ê²€ì¦ ë¡œì§ í™•ì¸
   - API ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ìž¬ê²€ì¦ ì—¬ë¶€ í™•ì¸

### ìš°ì„ ìˆœìœ„ ì¤‘ê°„

3. **âœ… SchemaEditorForm ì´ˆê¸°ê°’ ìˆ˜ì • - ì™„ë£Œ**
   - âœ… `minClient` í•„ë“œ í¬í•¨

4. **ë¬¸ì„œ ì—…ë°ì´íŠ¸**
   - Schema Editor ì‚¬ìš© ê°€ì´ë“œì— `minClient` ìš°ì„  ì‚¬ìš© ëª…ì‹œ

---

## âœ… ì¢…í•© í‰ê°€

### ì „ì²´ ì¤€ìˆ˜ë„: 98%

**ê°•ì **:
- íƒ€ìž… ì •ì˜ì™€ êµ¬í˜„ ë¡œì§ì´ ê¸°ìˆ ë¬¸ì„œì™€ ê±°ì˜ ì™„ë²½ížˆ ì¼ì¹˜
- ë³´ì•ˆ ì›ì¹™ (Zero-Trust) ì¤€ìˆ˜
- Condition Rule í‰ê°€ ë¡œì§ ì •í™•
- Validator ê²€ì¦ ê·œì¹™ ì™„ì „ êµ¬í˜„
- âœ… `minClient` í•„ë“œ ì¶”ê°€ ì™„ë£Œ (SDUI v1.1 ê·œê²© ì¤€ìˆ˜)

**ê°œì„  í•„ìš”**:
- Server-Side Validation í™•ì¸ (Hook ë‚´ë¶€ ë¡œì§ í™•ì¸ í•„ìš”)

**ê²°ë¡ **:
ìŠ¤í‚¤ë§ˆì—”ì§„ê³¼ ìŠ¤í‚¤ë§ˆì—ë””í„°ëŠ” ê¸°ìˆ ë¬¸ì„œ ìš”êµ¬ì‚¬í•­ì„ ê±°ì˜ ì™„ë²½ížˆ ì¶©ì¡±í•˜ê³  ìžˆìŠµë‹ˆë‹¤. 
`minClient` í•„ë“œ ì¶”ê°€ê°€ ì™„ë£Œë˜ì–´ SDUI v1.1 ê·œê²©ì„ ì¤€ìˆ˜í•©ë‹ˆë‹¤.
Server-Side Validation í™•ì¸ë§Œ ë‚¨ì•„ìžˆìŠµë‹ˆë‹¤.

