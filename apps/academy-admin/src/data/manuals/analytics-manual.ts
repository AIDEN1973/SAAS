/**
 * 통계 페이지 매뉴얼
 *
 * [불변 규칙] 매뉴얼 컨텐츠는 명확하고 이해하기 쉽게 작성합니다.
 */

import type { ManualPage } from '../../types/manual';

export const analyticsManual: ManualPage = {
  id: 'analytics',
  title: '통계',
  description: '학원의 운영 현황을 다양한 지표와 차트로 분석하고 확인하는 페이지입니다.',
  icon: 'BarChart2',
  lastUpdated: '2026-01-11',
  sections: [
    {
      id: 'intro',
      title: '이 화면, 언제 사용하나요?',
      type: 'intro',
      intro:
        '학원의 **운영 현황을 한눈에 파악**하는 통계 대시보드입니다. 학생 수, 매출, 출석률, 성장률 등 핵심 지표를 확인하고, **우리 학원이 같은 지역의 다른 학원과 비교해서 어느 정도 위치인지** 알 수 있습니다. AI가 분석한 인사이트와 히트맵을 통해 학원 운영에 필요한 중요한 정보를 얻을 수 있습니다.',
    },
    {
      id: 'features',
      title: '주요 기능',
      type: 'features',
      features: [
        '운영 현황 카드 : 학생 수, 매출, 출석률, 성장률 등 핵심 지표를 카드 형태로 표시',
        '지역 순위 확인 : 같은 지역 내에서 우리 학원의 순위와 상위 퍼센트 확인',
        '지역 비교 차트 : 우리 학원, 지역 평균, 상위 10% 평균을 막대 차트로 비교',
        'AI 인사이트 : AI가 분석한 운영 현황 요약과 개선 제안',
        '출석 패턴 분석 : 시간대별, 요일별 출석 패턴을 차트로 확인',
        '히트맵 : 날짜별 지표 변화를 색상 강도로 시각화',
        '지표 선택 : 확인하고 싶은 지표를 버튼으로 선택하여 상세 분석',
        '월간 리포트 생성 : 월간 경영 리포트를 PDF로 다운로드',
        '반응형 레이아웃 : 데스크톱, 태블릿, 모바일에서 최적화된 화면 제공',
      ],
    },
    {
      id: 'steps',
      title: '단계별 사용법',
      type: 'steps',
      stepGuides: [
        {
          title: '기본 통계 확인하기',
          steps: [
            { step: 1, content: '통계 페이지에 접속하면 자동으로 이번 달 기준의 핵심 지표들이 카드 형태로 표시됩니다.' },
            { step: 2, content: '각 카드에는 학생 수, 매출, 출석률, 성장률 등의 숫자와 지역 순위가 함께 표시됩니다.' },
            { step: 3, content: '카드를 클릭하면 해당 지표가 선택되어 하단에 상세 분석 정보가 표시됩니다.' },
            { step: 4, content: 'AI 인사이트 영역에서 AI가 분석한 운영 현황 요약을 확인합니다.' },
          ],
          alert: {
            type: 'info',
            content: '지역 통계는 같은 지역에 최소 3개 이상의 학원 데이터가 있어야 비교가 가능합니다.',
          },
        },
        {
          title: '특정 지표 상세 분석하기',
          steps: [
            { step: 1, content: '화면 상단의 지표 선택 버튼 영역에서 분석하고 싶은 지표 버튼을 클릭합니다.' },
            { step: 2, content: '선택 가능한 지표 : 학생 수, 매출, 출석률, 성장률, 신규 등록, ARPU, 정원률, 미납률, 이탈률, 지각률, 결석률' },
            { step: 3, content: '선택한 지표에 대한 우리 학원 값, 지역 평균, 상위 10% 평균이 막대 차트로 표시됩니다.' },
            { step: 4, content: '지역 순위 카드에서 해당 지표 기준 우리 학원의 순위와 상위 퍼센트를 확인합니다.' },
          ],
        },
        {
          title: '출석 패턴 분석하기',
          steps: [
            { step: 1, content: '페이지를 아래로 스크롤하여 출석 패턴 분석 카드를 찾습니다.' },
            { step: 2, content: '시간대별 차트에서 어느 시간대에 학생들이 많이 등원하는지 확인합니다.' },
            { step: 3, content: '요일별 차트에서 어느 요일에 출석률이 높은지/낮은지 확인합니다.' },
            { step: 4, content: '출석, 지각, 결석 비율을 색상으로 구분하여 확인할 수 있습니다.' },
          ],
          alert: {
            type: 'success',
            content: '출석 패턴을 분석하면 수업 시간표 최적화에 도움이 됩니다.',
          },
        },
        {
          title: '히트맵으로 추세 확인하기',
          steps: [
            { step: 1, content: '페이지 하단의 히트맵 카드를 찾습니다.' },
            { step: 2, content: '히트맵 유형 선택 버튼에서 확인하고 싶은 지표(성장률, 출석률, 학생 수)를 선택합니다.' },
            { step: 3, content: '날짜별로 색상 강도가 다르게 표시됩니다. 진한 색일수록 높은 값을 의미합니다.' },
            { step: 4, content: '최근 30일간의 데이터 변화 추세를 한눈에 파악할 수 있습니다.' },
          ],
        },
        {
          title: '월간 리포트 생성하기',
          steps: [
            { step: 1, content: '페이지 상단 오른쪽의 "월간 리포트 생성" 버튼을 클릭합니다.' },
            { step: 2, content: '시스템이 이번 달의 핵심 지표와 분석 결과를 수집합니다.' },
            { step: 3, content: 'PDF 파일이 자동으로 생성되어 다운로드됩니다.' },
            { step: 4, content: '생성 완료 메시지와 함께 핵심 지표 요약이 팝업으로 표시됩니다.' },
          ],
          alert: {
            type: 'info',
            content: '월간 리포트는 학원명, 지역, 핵심 지표, 지역 비교, AI 인사이트가 포함됩니다.',
          },
        },
      ],
    },
    {
      id: 'screen',
      title: '화면 뜯어보기',
      type: 'screen',
      screenGroups: [
        {
          title: '상단 헤더 영역',
          items: [
            { title: '페이지 제목', description: '"지역 기반 통계"라는 제목이 표시됩니다.' },
            { title: '월간 리포트 생성 버튼', description: '클릭하면 이번 달 경영 리포트를 PDF로 생성하고 다운로드합니다.' },
          ],
        },
        {
          title: '지표 선택 영역',
          items: [
            { title: '지표 버튼들', description: '학생 수, 매출, 출석률, 성장률, 신규 등록, ARPU, 정원률, 미납률, 이탈률, 지각률, 결석률 버튼이 있습니다.' },
            { title: '선택된 지표', description: '현재 선택된 지표는 버튼이 강조 표시됩니다. 클릭하여 다른 지표로 변경할 수 있습니다.' },
          ],
        },
        {
          title: '운영 현황 카드 (핵심 지표)',
          items: [
            { title: '학생 수 카드', description: '현재 등록된 학생 수와 지역 순위가 표시됩니다.' },
            { title: '매출 카드', description: '이번 달 매출 금액과 지역 순위가 표시됩니다.' },
            { title: '출석률 카드', description: '이번 달 평균 출석률(%)과 지역 순위가 표시됩니다.' },
            { title: '성장률 카드', description: '전월 대비 학생 수 변화율(%)과 지역 순위가 표시됩니다.' },
            { title: '신규 등록 카드', description: '이번 달 새로 등록한 학생 수가 표시됩니다.' },
            { title: 'ARPU 카드', description: '학생 1인당 평균 매출(Average Revenue Per User)이 표시됩니다.' },
            { title: '정원률 카드', description: '전체 정원 대비 현재 학생 수 비율(%)이 표시됩니다.' },
            { title: '미납률 카드', description: '전체 청구액 대비 미납액 비율(%)이 표시됩니다. 낮을수록 좋습니다.' },
            { title: '이탈률 카드', description: '전체 학생 중 비활성/이탈 학생 비율(%)이 표시됩니다. 낮을수록 좋습니다.' },
            { title: '지각률 카드', description: '전체 출결 중 지각 비율(%)이 표시됩니다. 낮을수록 좋습니다.' },
            { title: '결석률 카드', description: '전체 출결 중 결석 비율(%)이 표시됩니다. 낮을수록 좋습니다.' },
          ],
        },
        {
          title: 'AI 인사이트 카드',
          items: [
            { title: '인사이트 메시지', description: 'AI가 분석한 운영 현황 요약이 문장 형태로 표시됩니다.' },
            { title: '지역 비교 결과', description: '지역 평균 대비 우리 학원이 우수한지, 부족한지 알려줍니다.' },
            { title: '상위 퍼센트', description: '우리 학원이 해당 지역에서 상위 몇 퍼센트인지 표시합니다.' },
          ],
        },
        {
          title: '출석 패턴 분석 카드',
          items: [
            { title: '시간대별 차트', description: '0시부터 23시까지 각 시간대별 출석/지각/결석 비율이 막대 차트로 표시됩니다.' },
            { title: '요일별 차트', description: '일요일부터 토요일까지 각 요일별 출석/지각/결석 비율이 막대 차트로 표시됩니다.' },
            { title: '색상 범례', description: '출석(정상)은 파란색, 지각은 주황색, 결석은 빨간색으로 구분됩니다.' },
          ],
        },
        {
          title: '지역 비교 차트',
          items: [
            { title: '우리 조직 막대', description: '우리 학원의 해당 지표 값이 파란색 막대로 표시됩니다.' },
            { title: '지역 평균 막대', description: '같은 지역 학원들의 평균 값이 하늘색 막대로 표시됩니다.' },
            { title: '상위 10% 평균 막대', description: '같은 지역에서 상위 10%에 해당하는 학원들의 평균 값이 초록색 막대로 표시됩니다.' },
            { title: '숫자 표시', description: '각 막대 아래에 실제 숫자 값이 표시됩니다.' },
          ],
        },
        {
          title: '지역 순위 카드',
          items: [
            { title: '순위 표시', description: '우리 학원의 지역 내 순위가 크게 표시됩니다. 예 : "5위"' },
            { title: '지역명', description: '비교 기준이 되는 지역 이름(동/구)이 표시됩니다.' },
            { title: '상위 퍼센트', description: '전체 학원 중 상위 몇 퍼센트인지 표시됩니다. 예 : "상위 20%"' },
            { title: '우리 조직 값', description: '선택한 지표의 우리 학원 값이 표시됩니다.' },
            { title: '지역 평균 값', description: '선택한 지표의 지역 평균 값이 표시됩니다.' },
            { title: '변화율', description: '지역 평균 대비 우리 학원의 변화율(%)이 표시됩니다. 양수면 우수, 음수면 부족.' },
          ],
        },
        {
          title: '히트맵 카드',
          items: [
            { title: '유형 선택 버튼', description: '성장률, 출석률, 학생 수 중 하나를 선택할 수 있습니다.' },
            { title: '날짜별 셀', description: '최근 30일간의 데이터가 날짜별 셀로 표시됩니다.' },
            { title: '색상 강도', description: '값이 높을수록 진한 색상, 낮을수록 연한 색상으로 표시됩니다.' },
            { title: '마우스 오버', description: '셀에 마우스를 올리면 해당 날짜와 정확한 값이 표시됩니다.' },
          ],
        },
      ],
    },
    {
      id: 'tips',
      title: '알아두면 좋은 팁 & 주의사항',
      type: 'screen',
      screenGroups: [
        {
          title: '꼭 알아야 할 주의사항',
          items: [
            { title: '지역 설정 필수', description: '지역 통계를 보려면 학원의 지역 정보가 설정되어 있어야 합니다. 환경설정에서 지역을 설정하세요.' },
            { title: '최소 샘플 수', description: '같은 지역에 최소 3개 이상의 학원 데이터가 있어야 지역 비교가 가능합니다. 부족하면 "통계 제공 불가" 메시지가 표시됩니다.' },
            { title: '데이터 갱신 주기', description: '통계 데이터는 실시간이 아니며, 일정 주기(약 5초)로 자동 갱신됩니다.' },
            { title: '비교 그룹 단계', description: '동 단위 비교가 안 되면 구, 시도, 권역 순으로 자동 확장하여 비교합니다.' },
          ],
        },
        {
          title: '효율적으로 사용하는 팁',
          items: [
            { title: '핵심 지표 먼저 확인', description: '학생 수, 매출, 출석률, 성장률 4가지 핵심 지표를 먼저 확인하세요.' },
            { title: 'AI 인사이트 활용', description: 'AI 인사이트는 복잡한 데이터를 쉽게 이해할 수 있도록 문장으로 요약해줍니다.' },
            { title: '출석 패턴으로 수업 최적화', description: '어느 시간대에 학생이 많이 오는지 파악하여 수업 시간표를 최적화할 수 있습니다.' },
            { title: '히트맵으로 추세 파악', description: '히트맵을 보면 최근 한 달간의 변화 추세를 한눈에 파악할 수 있습니다.' },
            { title: '월간 리포트 활용', description: '월말에 월간 리포트를 생성하여 운영 현황을 정리하고 기록으로 남겨두세요.' },
          ],
        },
        {
          title: '지표 이해하기',
          items: [
            { title: 'ARPU (Average Revenue Per User)', description: '학생 1인당 평균 매출입니다. 총 매출을 학생 수로 나눈 값입니다.' },
            { title: '성장률', description: '전월 대비 학생 수 변화율입니다. 양수면 증가, 음수면 감소를 의미합니다.' },
            { title: '정원률', description: '학원 정원 대비 현재 학생 수 비율입니다. 100%에 가까울수록 정원이 찼다는 의미입니다.' },
            { title: '미납률', description: '전체 청구액 대비 미납액 비율입니다. 낮을수록 수납 관리가 잘 되고 있다는 의미입니다.' },
            { title: '이탈률', description: '전체 학생 중 비활성 또는 이탈한 학생 비율입니다. 낮을수록 학생 유지가 잘 되고 있다는 의미입니다.' },
          ],
        },
        {
          title: '문제 해결',
          items: [
            { title: '지역 비교가 안 돼요', description: '학원의 지역 정보가 설정되어 있는지 확인하세요. 환경설정 > 학원 정보에서 지역을 설정할 수 있습니다.' },
            { title: '"통계 제공 불가" 메시지', description: '같은 지역에 비교할 학원 수가 부족합니다. 이 경우 더 넓은 지역(구, 시도) 기준으로 비교됩니다.' },
            { title: '데이터가 0으로 표시돼요', description: '해당 기간에 데이터가 없을 수 있습니다. 출결 기록, 수납 기록이 있는지 확인하세요.' },
            { title: '리포트 생성이 안 돼요', description: '인터넷 연결을 확인하고 다시 시도해보세요. 문제가 지속되면 관리자에게 문의하세요.' },
          ],
        },
      ],
    },
    {
      id: 'mobile',
      title: '모바일/태블릿에서 사용하기',
      type: 'screen',
      screenGroups: [
        {
          title: '모바일에서의 차이점',
          items: [
            { title: '카드 1열 배치', description: '스마트폰에서는 운영 현황 카드가 1열로 세로 배치됩니다.' },
            { title: '스크롤', description: '화면을 위아래로 스크롤하여 모든 통계 정보를 확인할 수 있습니다.' },
            { title: '지표 버튼 줄바꿈', description: '지표 선택 버튼들이 여러 줄로 자동 줄바꿈됩니다.' },
            { title: '작은 버튼 크기', description: '월간 리포트 생성 버튼이 작은 크기로 표시됩니다.' },
          ],
        },
        {
          title: '태블릿에서의 차이점',
          items: [
            { title: '카드 2열 배치', description: '태블릿에서는 운영 현황 카드가 2열로 배치되어 한 화면에 더 많은 정보를 볼 수 있습니다.' },
            { title: '차트 크기', description: '지역 비교 차트와 히트맵이 적절한 크기로 표시됩니다.' },
          ],
        },
        {
          title: '데스크톱에서의 차이점',
          items: [
            { title: '카드 3열 배치', description: '데스크톱에서는 운영 현황 카드가 3열로 배치됩니다.' },
            { title: '넓은 차트', description: '지역 비교 차트와 히트맵이 넓게 표시되어 상세 정보를 확인하기 좋습니다.' },
            { title: '전체 화면 활용', description: '넓은 화면을 활용하여 모든 통계 정보를 한눈에 파악할 수 있습니다.' },
          ],
        },
      ],
    },
    {
      id: 'technical',
      title: '기술적 특징',
      type: 'technical',
      technicalFeatures: [
        'React Query 기반 데이터 캐싱 및 5초 주기 자동 리페칭',
        'Fallback 우선순위 : 동 -> 구 -> 시도 -> 권역 순 지역 비교',
        'Percentile Rank 계산 : p25, p50, p75 기반 상위 퍼센트 추정',
        'AI 인사이트 자동 생성 및 ai_insights 테이블 저장',
        'ranking_snapshot 테이블에 일별 순위 기록',
        'fetchDailyRegionMetrics 함수로 지역 통계 조회 (SSOT)',
        'useResponsiveMode 훅 기반 반응형 레이아웃 (XS/SM/MD/LG/XL)',
        'CSS 변수 기반 디자인 시스템',
        'KST 기준 날짜 처리 (dayjs)',
        'PDF 생성 및 다운로드 (월간 리포트)',
        'Zero-Trust : tenantId는 Context에서 자동 가져옴',
        'ErrorBoundary로 에러 격리 및 안전한 렌더링',
      ],
    },
  ],
};
