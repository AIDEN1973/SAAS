/**
 * 수납/청구 관리 페이지 매뉴얼
 *
 * [불변 규칙] 매뉴얼 컨텐츠는 명확하고 이해하기 쉽게 작성합니다.
 */

import type { ManualPage } from '../../types/manual';

export const billingManual: ManualPage = {
  id: 'billing',
  title: '수납/청구 관리',
  description: '학원의 수납 내역을 관리하고, 청구서를 생성하며, 미납을 관리하는 페이지입니다.',
  icon: 'CreditCard',
  lastUpdated: '2026-01-11',
  sections: [
    {
      id: 'intro',
      title: '이 화면, 언제 사용하나요?',
      type: 'intro',
      intro:
        '학원의 **수납과 청구를 관리**하는 핵심적인 화면입니다. 좌측 메뉴에서 **"더보기" → "수납관리"**를 클릭하여 접근합니다. 학생별 청구서를 생성하고, 결제 상태를 확인하며, 미납 내역을 관리합니다. **월 자동 청구 기능**이 있어 매월 정기 청구서가 자동으로 생성되고, **미납 알림**을 통해 수납률을 높일 수 있습니다. 수납 홈에서는 이번 달 예상 수납률, 자동 청구 진행 현황, 결제 현황 등을 한눈에 파악할 수 있습니다.',
    },
    {
      id: 'features',
      title: '주요 기능',
      type: 'features',
      features: [
        '수납 홈 대시보드 : 이번 달 예상 수납률, 자동 청구 현황, 결제 요약을 한눈에 확인',
        '청구서 목록 조회 : 모든 청구서를 상태별로 필터링하여 조회',
        '청구서 상태 필터 : 전체, 초안, 대기, 완료, 미납, 취소 상태별 필터링',
        '새 청구서 생성 : 학생별 신규 청구서를 수동으로 생성',
        '월 자동 청구 : 매일 04:00에 자동으로 월정액 청구서 생성',
        '미납 관리 : 7일 이상 미납 건 긴급 알림 및 관리',
        '수납 통계 : 이번 달 총 청구 금액, 결제 완료 금액, 수납률 확인',
        '영수증 발급 : 결제 완료된 청구서에 대한 영수증 조회 및 발급',
        '관련 기능 바로가기 : 상품 관리, 결제 관리, 매출/정산 페이지로 빠르게 이동',
      ],
    },
    {
      id: 'steps',
      title: '단계별 사용법',
      type: 'steps',
      stepGuides: [
        {
          title: '수납 홈에서 현황 파악하기',
          steps: [
            { step: 1, content: '좌측 메뉴에서 "더보기"를 클릭한 후 "수납관리"를 선택하여 수납 대시보드에 접속합니다.' },
            { step: 2, content: '화면에 표시되는 카드들을 통해 이번 달 수납 현황을 한눈에 파악합니다.' },
            { step: 3, content: '"이번달 예상 수납률" 카드에서 현재까지의 수납 진행률을 확인합니다.' },
            { step: 4, content: '"긴급 알림" 카드가 있다면 클릭하여 7일 이상 미납된 청구서를 확인합니다.' },
            { step: 5, content: '"전체 청구서 보기" 버튼을 클릭하면 청구서 목록 페이지로 이동합니다.' },
          ],
          alert: {
            type: 'info',
            content: '수납 홈의 카드들은 우선순위에 따라 자동으로 정렬됩니다. 긴급한 알림이 항상 상단에 표시됩니다.',
          },
        },
        {
          title: '청구서 목록 조회하기',
          steps: [
            { step: 1, content: '수납 홈에서 "전체 청구서 보기"를 클릭하거나, 청구서 탭을 선택합니다.' },
            { step: 2, content: '상단의 상태 필터 버튼을 클릭하여 원하는 상태의 청구서만 볼 수 있습니다.' },
            { step: 3, content: '"전체" 버튼을 클릭하면 모든 청구서가 표시됩니다.' },
            { step: 4, content: '"미납" 버튼을 클릭하면 결제 기한이 지난 청구서만 표시됩니다.' },
            { step: 5, content: '청구서 목록은 생성일 기준 최신순으로 정렬됩니다.' },
          ],
        },
        {
          title: '새 청구서 생성하기',
          steps: [
            { step: 1, content: '청구서 목록 화면에서 우측 상단의 "새 청구서 생성" 버튼을 클릭합니다.' },
            { step: 2, content: '모달(또는 드로어) 창이 열리면 청구 대상자를 선택합니다.' },
            { step: 3, content: '청구 금액을 입력합니다. 상품 정보가 있다면 자동으로 금액이 채워집니다.' },
            { step: 4, content: '결제 기한 날짜를 선택합니다.' },
            { step: 5, content: '입력 내용을 확인한 후 "생성" 또는 "저장" 버튼을 클릭합니다.' },
            { step: 6, content: '"청구서가 생성되었습니다" 메시지가 표시되면 성공입니다.' },
          ],
          alert: {
            type: 'success',
            content: '청구서가 생성되면 자동으로 목록에 추가되고, "초안" 상태로 저장됩니다.',
          },
        },
        {
          title: '미납 청구서 관리하기',
          steps: [
            { step: 1, content: '청구서 목록에서 "미납" 필터를 클릭합니다.' },
            { step: 2, content: '미납 상태의 청구서 목록이 표시됩니다.' },
            { step: 3, content: '각 청구서의 미납 기간과 금액을 확인합니다.' },
            { step: 4, content: '보호자에게 연락하여 결제를 안내합니다.' },
            { step: 5, content: '결제가 완료되면 해당 청구서의 상태가 자동으로 "완료"로 변경됩니다.' },
          ],
          alert: {
            type: 'warning',
            content: '7일 이상 미납된 청구서는 수납 홈에 긴급 알림으로 표시됩니다.',
          },
        },
        {
          title: '영수증 발급하기',
          steps: [
            { step: 1, content: '청구서 목록에서 "완료" 필터를 클릭하여 결제 완료된 청구서를 확인합니다.' },
            { step: 2, content: '영수증이 필요한 청구서를 클릭하여 상세 정보를 엽니다.' },
            { step: 3, content: '상세 화면에서 "영수증 발급" 또는 "영수증 보기" 버튼을 클릭합니다.' },
            { step: 4, content: '영수증 화면이 표시되면 인쇄하거나 PDF로 저장할 수 있습니다.' },
          ],
        },
      ],
    },
    {
      id: 'screen',
      title: '화면 뜯어보기',
      type: 'screen',
      screenGroups: [
        {
          title: '수납 홈 화면',
          items: [
            { title: '페이지 제목', description: '"수납 홈"이라는 제목과 함께 "전체 청구서 보기" 버튼이 우측에 표시됩니다.' },
            { title: '긴급 알림 카드', description: '7일 이상 미납된 청구서가 있을 때 표시됩니다. 클릭하면 미납 목록으로 이동합니다.' },
            { title: '이번달 예상 수납률 카드', description: '이번 달 전체 청구 금액 대비 결제 완료된 금액의 비율을 퍼센트로 표시합니다.' },
            { title: '자동 청구 진행 현황 카드', description: '자동 청구 설정이 된 청구서의 비율을 표시합니다. 80% 이상이면 "완료", 미만이면 "진행 중"으로 표시됩니다.' },
            { title: '결제 현황 요약 카드', description: '이번 달 결제 완료된 청구서 건수를 표시합니다.' },
          ],
        },
        {
          title: '청구서 목록 화면 - 상단 영역',
          items: [
            { title: '페이지 제목', description: '"청구서 관리"라는 제목이 표시됩니다.' },
            { title: '관련 기능 바로가기', description: '"상품 관리", "결제 관리", "매출/정산" 버튼이 있어 관련 페이지로 빠르게 이동할 수 있습니다.' },
            { title: '상태 필터 버튼', description: '전체, 초안, 대기, 완료, 미납, 취소 버튼이 있어 청구서를 상태별로 필터링합니다.' },
            { title: '자동 청구 안내 문구', description: '"월 자동 청구는 매일 04:00에 자동으로 생성됩니다"라는 안내가 표시됩니다.' },
            { title: '새 청구서 생성 버튼', description: '클릭하면 새 청구서를 생성할 수 있는 폼이 열립니다.' },
          ],
        },
        {
          title: '청구서 목록 화면 - 테이블 영역',
          items: [
            { title: '청구서 번호', description: '각 청구서의 고유 번호가 표시됩니다.' },
            { title: '청구 대상자', description: '학생 또는 보호자 이름이 표시됩니다.' },
            { title: '청구 금액', description: '청구된 금액이 원화(KRW)로 표시됩니다.' },
            { title: '결제 기한', description: '결제해야 하는 마감일이 표시됩니다.' },
            { title: '상태', description: '초안(draft), 대기(pending), 완료(paid), 미납(overdue), 취소(cancelled) 중 하나가 표시됩니다.' },
            { title: '생성일', description: '청구서가 생성된 날짜가 표시됩니다.' },
          ],
        },
        {
          title: '청구서 생성 폼 (모달/드로어)',
          items: [
            { title: '청구 대상자 선택', description: '드롭다운에서 청구서를 발행할 학생 또는 보호자를 선택합니다.' },
            { title: '청구 금액 입력', description: '청구할 금액을 숫자로 입력합니다. 상품 선택 시 자동으로 채워질 수 있습니다.' },
            { title: '결제 기한 선택', description: '달력에서 결제 마감일을 선택합니다.' },
            { title: '생성/취소 버튼', description: '"생성" 버튼을 누르면 청구서가 저장되고, "취소" 버튼을 누르면 폼이 닫힙니다.' },
          ],
        },
      ],
    },
    {
      id: 'tips',
      title: '알아두면 좋은 팁 & 주의사항',
      type: 'screen',
      screenGroups: [
        {
          title: '꼭 알아야 할 주의사항',
          items: [
            { title: '자동 청구 시간', description: '월 자동 청구는 매일 오전 4시(한국 시간)에 자동으로 실행됩니다. 별도의 수동 실행은 필요하지 않습니다.' },
            { title: '미납 7일 경과 알림', description: '결제 기한이 7일 이상 지난 청구서는 수납 홈에 긴급 알림으로 표시됩니다. 빠른 확인이 필요합니다.' },
            { title: '청구서 상태 변경', description: '청구서 상태는 결제 진행에 따라 자동으로 변경됩니다. 수동 변경은 관리자 권한이 필요할 수 있습니다.' },
            { title: '삭제 주의', description: '취소된 청구서는 복구가 어려울 수 있습니다. 청구서 취소 전 신중하게 확인해주세요.' },
          ],
        },
        {
          title: '효율적으로 사용하는 팁',
          items: [
            { title: '수납 홈 활용', description: '매일 수납 홈을 확인하여 미납 현황과 수납률을 파악하세요. 문제가 있는 건을 빠르게 발견할 수 있습니다.' },
            { title: '상태별 필터 활용', description: '"미납" 필터를 자주 확인하여 결제가 지연된 건을 빠르게 처리하세요.' },
            { title: '관련 기능 바로가기', description: '청구서 관리 화면 상단의 바로가기 버튼을 활용하면 상품 관리, 결제 관리 페이지로 빠르게 이동할 수 있습니다.' },
            { title: '긴급 알림 우선 처리', description: '수납 홈에 긴급 알림이 표시되면 해당 건을 우선적으로 처리하세요.' },
            { title: '영수증 미리 발급', description: '보호자가 영수증을 요청하기 전에 결제 완료 시 미리 발급해두면 좋습니다.' },
          ],
        },
        {
          title: '문제 해결',
          items: [
            { title: '청구서가 생성되지 않아요', description: '필수 입력 항목(대상자, 금액, 기한)이 모두 입력되었는지 확인하세요. 입력값에 오류가 있으면 생성되지 않습니다.' },
            { title: '상태가 변경되지 않아요', description: '청구서 상태는 실제 결제 상태에 따라 변경됩니다. 결제가 처리되었는지 확인하세요.' },
            { title: '미납 목록에 없어요', description: '결제 기한이 아직 지나지 않은 청구서는 "대기" 상태로 표시됩니다. 기한 경과 후 "미납"으로 변경됩니다.' },
            { title: '카드가 표시되지 않아요', description: '이번 달 청구서가 아직 생성되지 않았을 수 있습니다. "전체 청구서 보기"를 클릭하여 확인하세요.' },
          ],
        },
      ],
    },
    {
      id: 'mobile',
      title: '모바일/태블릿에서 사용하기',
      type: 'screen',
      screenGroups: [
        {
          title: '모바일에서의 차이점',
          items: [
            { title: '카드 1열 표시', description: '스마트폰에서는 수납 홈의 카드들이 1열로 세로로 나열됩니다.' },
            { title: '드로어 폼', description: '새 청구서 생성 시 모달 대신 화면 하단에서 올라오는 드로어(서랍) 형태로 폼이 열립니다.' },
            { title: '테이블 스크롤', description: '청구서 목록 테이블은 좌우로 스크롤하여 모든 정보를 확인할 수 있습니다.' },
            { title: '필터 버튼 줄바꿈', description: '상태 필터 버튼들이 화면 너비에 맞게 자동으로 줄바꿈됩니다.' },
          ],
        },
        {
          title: '태블릿에서의 차이점',
          items: [
            { title: '카드 2열 표시', description: '태블릿에서는 수납 홈의 카드들이 2열로 표시되어 더 많은 정보를 한눈에 볼 수 있습니다.' },
            { title: '사이드 드로어', description: '새 청구서 생성 시 화면 오른쪽에서 나타나는 사이드 드로어 형태로 폼이 열립니다.' },
            { title: '넓은 테이블', description: '테이블이 더 넓게 표시되어 스크롤 없이 대부분의 정보를 확인할 수 있습니다.' },
          ],
        },
      ],
    },
    {
      id: 'technical',
      title: '기술적 특징',
      type: 'technical',
      technicalFeatures: [
        'React Query 기반 데이터 캐싱 및 5분 주기 자동 리페칭',
        'Schema Registry 기반 SDUI (Server-Driven UI) 폼 및 테이블 자동 생성',
        'Zero-Trust 아키텍처 : tenantId는 Context에서 자동 주입',
        'useMutation 기반 청구서 생성, 상태 업데이트, 정산 실행',
        'useResponsiveMode 훅 기반 반응형 레이아웃 (모바일/태블릿/데스크톱)',
        '월 자동 청구 : 매일 04:00 KST 배치 작업으로 자동 실행',
        'apiClient를 통한 안전한 API 요청 (api-sdk 레이어)',
        'KST 기준 날짜 처리 (dayjs toKST 유틸리티)',
        'CSS 변수 기반 디자인 시스템',
        'ErrorBoundary 기반 에러 처리',
        'SSOT 원칙 : createSafeNavigate를 통한 보안 네비게이션',
      ],
    },
  ],
};
